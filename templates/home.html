<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>MONA í™ˆ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        margin: 0;
        font-family: 'Segoe UI', sans-serif;
        background-color: #e8f6fb;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
      }

      .logo {
        margin-top: 50px;
        text-align: center;
      }

      .logo img {
        width: 300px;
        margin-bottom: 10px;
      }

      .logo h1 {
        margin: 0;
        font-size: 2.5em;
        color: #1e3a8a;
      }

      .logo p {
        font-size: 0.95em;
        color: #555;
      }

      .welcome-message {
        font-size: 1.5em;
        font-weight: bold;
        color: #333;
        margin-top: 30px;
        text-align: center;
      }

      .summary-section {
        width: 90%;
        max-width: 1000px;
        margin-top: 40px;
      }

      .large-card {
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        padding: 30px;
        text-align: center;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
      }

      .large-card img {
        width: 60px;
        margin-bottom: 15px;
      }

      .large-card h3 {
        margin: 0;
        color: #1e3a8a;
      }

      .large-card p {
        color: #666;
        margin-top: 8px;
        font-size: 0.9em;
      }

      .summary-generate-button {
        background-color: #4a90e2;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 12px;
        line-height: 1.5;
        align-self: center;
        font-size: 0.8em;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }

      .summary-generate-button:hover {
        background-color: #357abd;
      }

      .card-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 30px;
        width: 90%;
        max-width: 1000px;
        margin-top: 40px;
      }

      .card {
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        padding: 30px;
        text-align: center;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
      }

      .card:hover {
        transform: translateY(-5px);
      }

      .card img {
        width: 60px;
        margin-bottom: 15px;
      }

      .card h3 {
        margin: 0;
        color: #1e3a8a;
      }

      .card p {
        color: #666;
        margin-top: 8px;
        font-size: 0.9em;
      }

      .floating-setting {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 55px;
        height: 55px;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        background-color: white;
        padding: 10px;
        object-fit: contain;
        transition: transform 0.2s ease;
      }

      .floating-setting:hover {
        transform: scale(1.1);
      }
      .floating-setting {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 55px;
        height: 55px;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        background-color: white;
        padding: 10px;
        object-fit: contain;
        transition: transform 0.2s ease;
      }

      .floating-setting:hover {
        transform: scale(1.1);
      }

      .setting-menu {
        position: fixed;
        bottom: 100px;
        right: 30px;
        background-color: white;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        padding: 10px;
        z-index: 100;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .setting-menu button {
        background-color: #4a90e2;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 6px;
        font-size: 0.9em;
        cursor: pointer;
        white-space: nowrap;
      }

      .setting-menu button:hover {
        background-color: #357abd;
      }
    </style>
  </head>
  <body>
    <div class="logo">
      <img src="/static/_mona_logo.png" alt="MONA ë¡œê³ " />
    </div>

    <div class="welcome-message">í™˜ì˜í•©ë‹ˆë‹¤, {{ nickname }}ë‹˜!</div>

    <div class="summary-section">
      <div class="large-card">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h3 style="margin: 0">ì˜¤ëŠ˜ì˜ ìš”ì•½</h3>
          <button onclick="generateSummary()" class="summary-generate-button">
            ìš”ì•½ ìƒì„±í•˜ê¸°
          </button>
        </div>

        <pre
          id="summary-output"
          style="
            text-align: left;
            white-space: pre-wrap;
            font-size: 0.95em;
            color: #333;
            margin-top: 12px;
          "
        >
{{ summary_text }}
    </pre
        >
      </div>
    </div>

    <div class="card-grid">
      <div class="card" onclick="location.href='/emotions'">
        <img src="/static/emotions_icon.png" alt="ê°ì • ê¸°ë¡ ì•„ì´ì½˜" />
        <h3>ê°ì • ê¸°ë¡</h3>
        <p>ì˜¤ëŠ˜ì˜ ê°ì •ì„ ê¸°ë¡í•˜ê³  ê·¸ë˜í”„ë¡œ í™•ì¸í•˜ì„¸ìš”.</p>
      </div>

      <div class="card" onclick="location.href='/routines'">
        <img src="/static/routine_icon.png" alt="ë£¨í‹´ ê´€ë¦¬ ì•„ì´ì½˜" />
        <h3>ë£¨í‹´ ê´€ë¦¬</h3>
        <p>ë°˜ë³µì ì¸ ì¼ìƒì„ ê´€ë¦¬í•˜ê³  ìƒì‚°ì„±ì„ ë†’ì—¬ë³´ì„¸ìš”.</p>
      </div>

      <div class="card" onclick="location.href='/goal'">
        <img src="/static/goal_icon.png" alt="ëª©í‘œ ê´€ë¦¬ ì•„ì´ì½˜" />
        <h3>ëª©í‘œ ê´€ë¦¬</h3>
        <p>ì¥ê¸°ì ì¸ ëª©í‘œë¥¼ ì„¤ì •í•˜ê³  ë‹¬ì„± ê³¼ì •ì„ ì¶”ì í•˜ì„¸ìš”.</p>
      </div>

      <div class="card" onclick="location.href='/thought'">
        <img src="/static/thought_icon.png" alt="ìƒê° ê¸°ë¡ ì•„ì´ì½˜" />
        <h3>ìƒê° ê¸°ë¡</h3>
        <p>ììœ ë¡­ê²Œ ìƒê°ì„ ê¸°ë¡í•˜ê³  ì •ë¦¬í•˜ì„¸ìš”.</p>
      </div>
    </div>

    <img
      src="/static/settings_icon.png"
      alt="ì„¤ì •"
      class="floating-setting"
      onclick="toggleSettingMenu()"
    />
    <div id="setting-menu" class="setting-menu" style="display: none">
      <button onclick="goToTheme()">ğŸ¨ í…Œë§ˆ ì„¤ì •</button>
      <button onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>
    </div>

    <script>
      async function generateSummary() {
        try {
          const response = await fetch('/summary/generate', {
            method: 'GET',
            credentials: 'include',
          });
          const data = await response.json();

          if (data.summary) {
            document.getElementById('summary-output').textContent =
              data.summary;
          } else {
            alert('ìš”ì•½ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }
        } catch (e) {
          console.error('ìš”ì•½ ìƒì„± ì¤‘ ì˜¤ë¥˜:', e);
          alert('ìš”ì•½ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      }
      function toggleSettingMenu() {
        const menu = document.getElementById('setting-menu');
        menu.style.display = menu.style.display === 'none' ? 'flex' : 'none';
      }

      function goToTheme() {
        location.href = '/theme';
      }

      async function logout() {
        if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          await fetch('/logout', { method: 'POST', credentials: 'include' });
          window.location.href = '/login';
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        const color = localStorage.getItem('monaTheme');
        if (color) {
          document.body.style.backgroundColor = color;
        }
      });
    </script>
  </body>
</html>
